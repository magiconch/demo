# Minimap设计优化

背景：
> 当用户在左边区域操作dom时，右边缩略图能实时更新
> 截图非常耗性能
> 用户操作都有记录，当元素信息改变时，数据也会同步刷新

## 提高刷新性能

### 1. 采用canvas绘制

对于Minimap，我们可以采用canvas进行绘制，在用户创建dom的时候创建一个与dom相匹配的canvas元素，这里无论是zrender还是g，都支持这种元素化的canvas对象。这样做的好处在于进行大小改变，颜色绘制，位置改变的时候，我们可以根据计算出来的渲染大小精准进行画布刷新。

### 2. 进行canvas分层

我们需要将活跃的元素和非活跃元素进行分层渲染，这样当我们渲染的时候，可以减少渲染内容

## 减少刷新率

### 1. 采用节流函数

在用户操作的时候，用户的行为可能是连续的，即在修改颜色之后修改位置，这时候采用节流函数可以减少刷新次数，提高渲染性能。

### 2. 考虑用户的撤销操作

用户可能会在设置一个属性后不满意进行撤销，这时候可以减少一次刷新，所以我们也许需要一个用户的行为栈来临时储存用户行为。
